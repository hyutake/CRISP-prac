{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { useDispatch } from \"react\";\n\n/* \n    tasks: array of task objects -> { title:___, desc:___, deadline:___ }, 'title' & 'desc' are Strings, 'deadline' is a Date object\n*/\n\nconst initialTaskState = {\n  tasks: []\n  //quantity: 0,\n};\n\nconst taskSlice = createSlice({\n  name: \"task\",\n  initialState: initialTaskState,\n  reducers: {\n    addTask(state, action) {\n      // action will pass an entire task object\n      dispatch = useDispatch();\n      return async dispatch => {\n        const task = action.payload;\n        console.log(\"From task-slice addTask\");\n        console.log(task);\n        axios.post(\"http://localhost:3001/tasks\", {\n          title: task.title,\n          description: task.description,\n          deadline: task.deadline\n        }).then(response => {\n          // Handle the successful response\n          const createdTask = response.data;\n          console.log(createdTask);\n          // Add the created task to the state\n          //   state.tasks = state.tasks.map((task) => ({ ...task })); // Create a copy of each task\n          state.tasks.push(createdTask); // Append the createdTask object\n          // Trigger a page refresh\n          //window.location.reload();\n        }).catch(error => {\n          // Handle any errors\n          console.log(error.message);\n        });\n        state.tasks.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));\n      };\n    },\n    removeTask(state, action) {\n      // action will pass the id of a task\n      const id = action.payload;\n\n      // double confirm deletion\n      const proceed = window.confirm(\"Delete task?\");\n      if (proceed) {\n        state.tasks = state.tasks.filter(task => task._id !== id);\n        axios.delete(`http://localhost:3001/tasks/${id}`);\n      }\n    },\n    editTask(state, action) {\n      // action will pass the edited task\n      console.log(action.payload);\n      const {\n        id,\n        title,\n        description,\n        deadline,\n        completed\n      } = action.payload;\n\n      //Make the PUT request to update the task on the backend\n      axios.put(`http://localhost:3001/tasks/${id}`, {\n        title,\n        description,\n        deadline,\n        completed\n      });\n      // .then((response) => {\n      //   // Handle the successful response\n      //   const updatedTask = response.data;\n      //   //window.location.reload();\n\n      //  Update the task in the state with the updated values\n      const updatedTasks = state.tasks.map(task => {\n        if (task.id === id) {\n          return action.payload;\n        }\n        return task;\n      });\n      console.log(state);\n      //this.setTask(state, updatedTasks);\n      //const dispatch = useDispatch();\n      //dispatch(taskActions.setTask(updatedTasks));\n      //   return {\n      // \t...state,\n      // \ttasks: updatedTasks,\n      //   };\n\n      // });\n      //     })\n      //     .catch((error) => {\n      //       // Handle any errors\n      //       console.log(error.message);\n      //     });\n    },\n\n    setTask(state, action) {\n      console.log(action.payload);\n      state.tasks = action.payload;\n    }\n  }\n});\nexport const taskActions = taskSlice.actions;\nexport default taskSlice;","map":{"version":3,"names":["createSlice","axios","useDispatch","initialTaskState","tasks","taskSlice","name","initialState","reducers","addTask","state","action","dispatch","task","payload","console","log","post","title","description","deadline","then","response","createdTask","data","push","catch","error","message","sort","a","b","Date","removeTask","id","proceed","window","confirm","filter","_id","delete","editTask","completed","put","updatedTasks","map","setTask","taskActions","actions"],"sources":["/Users/matthewsamynathan/Documents/GitHub/CRISP-prac/frontend/src/store/task-slice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { useDispatch } from \"react\";\n\n/* \n    tasks: array of task objects -> { title:___, desc:___, deadline:___ }, 'title' & 'desc' are Strings, 'deadline' is a Date object\n*/\n\nconst initialTaskState = {\n  tasks: [],\n  //quantity: 0,\n};\n\nconst taskSlice = createSlice({\n\t\n  name: \"task\",\n  initialState: initialTaskState,\n  reducers: {\n    addTask(state, action) {\n      // action will pass an entire task object\n\t  dispatch = useDispatch();\n      return async (dispatch) =>{\n\t\tconst task = action.payload;\n      console.log(\"From task-slice addTask\");\n      console.log(task);\n\n      axios\n        .post(\"http://localhost:3001/tasks\", {\n          title: task.title,\n          description: task.description,\n          deadline: task.deadline,\n        })\n        .then((response) => {\n          // Handle the successful response\n          const createdTask = response.data;\n          console.log(createdTask);\n          // Add the created task to the state\n          //   state.tasks = state.tasks.map((task) => ({ ...task })); // Create a copy of each task\n        state.tasks.push(createdTask); // Append the createdTask object\n          // Trigger a page refresh\n          //window.location.reload();\n        })\n        .catch((error) => {\n          // Handle any errors\n          console.log(error.message);\n        });\n      state.tasks.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));\n\t  }\n    },\n    removeTask(state, action) {\n      // action will pass the id of a task\n      const id = action.payload;\n\n      // double confirm deletion\n      const proceed = window.confirm(\"Delete task?\");\n\n      if (proceed) {\n        state.tasks = state.tasks.filter((task) => task._id !== id);\n        axios.delete(`http://localhost:3001/tasks/${id}`);\n      }\n    },\n    editTask(state, action) {\n\t\t\n      // action will pass the edited task\n      console.log(action.payload);\n      const { id, title, description, deadline, completed } = action.payload;\n\t\n      //Make the PUT request to update the task on the backend\n      axios.put(`http://localhost:3001/tasks/${id}`, {\n        title,\n        description,\n        deadline,\n        completed,\n      });\n      // .then((response) => {\n      //   // Handle the successful response\n      //   const updatedTask = response.data;\n      //   //window.location.reload();\n\n      //  Update the task in the state with the updated values\n      const updatedTasks = state.tasks.map((task) => {\n        if (task.id === id) {\n          return action.payload;\n        }\n        return task;\n      });\n\t  console.log(state);\n\t  //this.setTask(state, updatedTasks);\n\t  //const dispatch = useDispatch();\n\t  //dispatch(taskActions.setTask(updatedTasks));\n      //   return {\n      // \t...state,\n      // \ttasks: updatedTasks,\n      //   };\n\n      // });\n      //     })\n      //     .catch((error) => {\n      //       // Handle any errors\n      //       console.log(error.message);\n      //     });\n    },\n    setTask(state, action) {\n      console.log(action.payload);\n      state.tasks = action.payload;\n    },\n  },\n});\n\nexport const taskActions = taskSlice.actions;\nexport default taskSlice;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}